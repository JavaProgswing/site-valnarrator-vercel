<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Valorant Narrator - Real-time Game Chat to Voice</title>
    <meta
      name="description"
      content="Valorant Narrator transforms game chat messages into real-time party and team voice communication with customizable agent voices."
    />
    <meta property="og:title" content="Valorant Narrator" />
    <meta
      property="og:description"
      content="Dictate your chat comms into team/party mic with fully customizable voices!"
    />
    <meta
      property="og:image"
      content="https://valnarrator.vercel.app/static/images/bg-site.png"
    />
    <meta name="theme-color" content="#ff4655" />

    <link rel="icon" href="static/app.ico" />
    <link rel="stylesheet" href="static/style.css" />
    <!-- Google Fonts included in style.css -->
  </head>
  <body>
    <!-- Hero Section -->
    <section class="hero">
      <div class="container hero-content">
        <h1>Valorant<br />Narrator</h1>
        <p>
          Transform text chat into real-time voice comms. Immerse yourself with
          authentic agent voices.
        </p>
        <div class="hero-buttons">
          <a href="/download" class="btn">Download Now</a>
          <a href="https://discord.gg/RWP25YQDcf" class="btn btn-outline"
            >Join Discord</a
          >
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section class="features">
      <div class="container">
        <h2 class="section-title">Features</h2>
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">
              <img
                src="static/images/7649719-99138a52.png"
                alt="Performance Icon"
              />
            </div>
            <h3>Zero Lag</h3>
            <p>
              Optimized for performance. Valorant Narrator runs seamlessly in
              the background with no impact on your FPS.
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <img src="static/images/563541-f40a75b3.png" alt="Config Icon" />
            </div>
            <h3>Highly Configurable</h3>
            <p>
              Customize everything from voice speed to specific trigger words.
              Make it truly yours.
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <img src="static/images/3138411-46379e46.png" alt="Voices Icon" />
            </div>
            <h3>Agent Voices</h3>
            <p>
              Choose from over 12+ voices, including your favorite agents. Free
              tier includes unlimited Windows voices.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials">
      <div class="container">
        <h2 class="section-title">Community Love</h2>
        <div class="testimonial-slider">
          <div class="testimonial-card">
            <p class="testimonial-text">
              "You are a community treasure my friend. If this works, It will be
              a godsend for me. I have lost count of the number of times when my
              teammate is typing in chat instead of using their mic."
            </p>
            <p class="testimonial-author">- Reddit User</p>
          </div>
          <div class="testimonial-card">
            <p class="testimonial-text">
              "That sounds like a pretty interesting and potentially useful
              application... hearing the chat come through as voice adds another
              layer to the game's communication system."
            </p>
            <p class="testimonial-author">- Reddit User</p>
          </div>
          <div class="testimonial-card">
            <p class="testimonial-text">
              "Being a girl, this will honestly save me a lot of sanity when not
              wanting to talk when there are toxic people in my match. I
              definitely see using this in the future."
            </p>
            <p class="testimonial-author">- Reddit User</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="cta">
      <div class="container">
        <h2>Ready to Upgrade Your Comms?</h2>
        <p>
          Free tier includes AWS Voices (limited) + Agent voices.<br /><strong
            >Go Premium for unlimited quota and offline access!</strong
          >
        </p>
        <div class="hero-buttons">
          <a href="/download" class="btn">Download App</a>
          <button id="buy-btn" class="btn btn-outline" style="cursor: pointer">
            Buy Premium (One-Time & Subscription)
          </button>
        </div>
        <div style="margin-top: 20px">
          <a
            href="/referral"
            id="referral-link"
            style="
              color: var(--val-gray);
              font-size: 0.9rem;
              text-decoration: underline;
            "
            >Have a Referral Code?</a
          >
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <a href="https://discord.gg/RWP25YQDcf" class="discord-link">
          <img src="static/images/discordlogo.png" alt="Discord" />
          Join our Community
        </a>
        <div class="footer-links">
          <a href="/TermsOfService">Terms of Service</a>
          <a href="/PrivacyPolicy">Privacy Policy</a>
          <a href="/CancellationRefundPolicy">Refund Policy</a>
        </div>
        <p style="margin-top: 20px; color: #555; font-size: 0.8rem">
          &copy; 2023 Valorant Narrator. Not affiliated with Riot Games.
        </p>
      </div>
    </footer>

    <!-- Payment Modal -->
    <div id="payment-modal" class="modal-overlay">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2
          style="text-align: center; margin-bottom: 20px; color: var(--val-red)"
        >
          Choose Your Plan
        </h2>

        <div class="payment-tabs">
          <button class="tab-btn active" onclick="switchTab('one-time')">
            One Time
          </button>
          <button class="tab-btn" onclick="switchTab('subscription')">
            Subscription
          </button>
        </div>

        <!-- One Time Payment Tab -->
        <div id="one-time" class="tab-content active">
          <div class="input-group" id="one-time-user-id-group">
            <label for="one-time-user-id">User ID (from App)</label>
            <input
              type="text"
              id="one-time-user-id"
              placeholder="Enter your User ID"
            />
          </div>

          <div
            id="onetime-payment-section"
            style="
              margin-top: 20px;
              padding: 20px;
              background: rgba(255, 255, 255, 0.05);
              border-radius: 12px;
              border: 1px solid rgba(255, 70, 85, 0.3);
            "
          >
            <div style="text-align: center; margin-bottom: 20px">
              <h3
                style="
                  color: var(--val-red);
                  margin: 0 0 8px 0;
                  font-size: 1.5rem;
                  font-weight: 700;
                "
              >
                ValNarrator Premium
              </h3>
              <div
                style="
                  color: #ebebf0;
                  font-size: 2rem;
                  font-weight: bold;
                  margin: 8px 0;
                "
              >
                $4.99
              </div>
              <p
                style="
                  color: var(--val-gray);
                  margin: 12px 0 0 0;
                  line-height: 1.6;
                  font-size: 0.95rem;
                "
              >
                Enhanced in-game text-to-speech experience for Valorant players.
                Includes unlimited narration quota, premium voice options, and
                faster performance.
              </p>
            </div>
            <div
              id="payment-buttons-container"
              style="
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 100%;
                gap: 15px;
              "
            >
              <!-- PayPal Smart Button -->
              <button
                id="one-time-paypal-btn"
                class="btn"
                style="
                  width: 200px;
                  height: 48px;
                  clip-path: none;
                  border-radius: 4px;
                  background-color: #7f5900;
                  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAxcHgiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAxMDEgMzIiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaW5ZTWluIG1lZXQiIHhtbG5zPSJodHRwOiYjeDJGOyYjeDJGO3d3dy53My5vcmcmI3gyRjsyMDAwJiN4MkY7c3ZnIj48cGF0aCBmaWxsPSIjMDAzMDg3IiBkPSJNIDEyLjIzNyAyLjggTCA0LjQzNyAyLjggQyAzLjkzNyAyLjggMy40MzcgMy4yIDMuMzM3IDMuNyBMIDAuMjM3IDIzLjcgQyAwLjEzNyAyNC4xIDAuNDM3IDI0LjQgMC44MzcgMjQuNCBMIDQuNTM3IDI0LjQgQyA1LjAzNyAyNC40IDUuNTM3IDI0IDUuNjM3IDIzLjUgTCA2LjQzNyAxOC4xIEMgNi41MzcgMTcuNiA2LjkzNyAxNy4yIDcuNTM3IDE3LjIgTCAxMC4wMzcgMTcuMiBDIDE1LjEzNyAxNy4yIDE4LjEzNyAxNC43IDE4LjkzNyA5LjggQyAxOS4yMzcgNy43IDE4LjkzNyA2IDE3LjkzNyA0LjggQyAxNi44MzcgMy41IDE0LjgzNyAyLjggMTIuMjM3IDIuOCBaIE0gMTMuMTM3IDEwLjEgQyAxMi43MzcgMTIuOSAxMC41MzcgMTIuOSA4LjUzNyAxMi45IEwgNy4zMzcgMTIuOSBMIDguMTM3IDcuNyBDIDguMTM3IDcuNCA4LjQzNyA3LjIgOC43MzcgNy4yIEwgOS4yMzcgNy4yIEMgMTAuNjM3IDcuMiAxMS45MzcgNy4yIDEyLjYzNyA4IEMgMTMuMTM3IDguNCAxMy4zMzcgOS4xIDEzLjEzNyAxMC4xIFoiPjwvcGF0aD48cGF0aCBmaWxsPSIjMDAzMDg3IiBkPSJNIDM1LjQzNyAxMCBMIDMxLjczNyAxMCBDIDMxLjQzNyAxMCAzMS4xMzcgMTAuMiAzMS4xMzcgMTAuNSBMIDMwLjkzNyAxMS41IEwgMzAuNjM3IDExLjEgQyAyOS44MzcgOS45IDI4LjAzNyA5LjUgMjYuMjM3IDkuNSBDIDIyLjEzNyA5LjUgMTguNjM3IDEyLjYgMTcuOTM3IDE3IEMgMTcuNTM3IDE5LjIgMTguMDM3IDIxLjMgMTkuMzM3IDIyLjcgQyAyMC40MzcgMjQgMjIuMTM3IDI0LjYgMjQuMDM3IDI0LjYgQyAyNy4zMzcgMjQuNiAyOS4yMzcgMjIuNSAyOS4yMzcgMjIuNSBMIDI5LjAzNyAyMy41IEMgMjguOTM3IDIzLjkgMjkuMjM3IDI0LjMgMjkuNjM3IDI0LjMgTCAzMy4wMzcgMjQuMyBDIDMzLjUzNyAyNC4zIDM0LjAzNyAyMy45IDM0LjEzNyAyMy40IEwgMzYuMTM3IDEwLjYgQyAzNi4yMzcgMTAuNCAzNS44MzcgMTAgMzUuNDM3IDEwIFogTSAzMC4zMzcgMTcuMiBDIDI5LjkzNyAxOS4zIDI4LjMzNyAyMC44IDI2LjEzNyAyMC44IEMgMjUuMDM3IDIwLjggMjQuMjM3IDIwLjUgMjMuNjM3IDE5LjggQyAyMy4wMzcgMTkuMSAyMi44MzcgMTguMiAyMy4wMzcgMTcuMiBDIDIzLjMzNyAxNS4xIDI1LjEzNyAxMy42IDI3LjIzNyAxMy42IEMgMjguMzM3IDEzLjYgMjkuMTM3IDE0IDI5LjczNyAxNC42IEMgMzAuMjM3IDE1LjMgMzAuNDM3IDE2LjIgMzAuMzM3IDE3LjIgWiI+PC9wYXRoPjxwYXRoIGZpbGw9IiMwMDMwODciIGQ9Ik0gNTUuMzM3IDEwIEwgNTEuNjM3IDEwIEMgNTEuMjM3IDEwIDUwLjkzNyAxMC4yIDUwLjczNyAxMC41IEwgNDUuNTM3IDE4LjEgTCA0My4zMzcgMTAuOCBDIDQzLjIzNyAxMC4zIDQyLjczNyAxMCA0Mi4zMzcgMTAgTCAzOC42MzcgMTAgQyAzOC4yMzcgMTAgMzcuODM3IDEwLjQgMzguMDM3IDEwLjkgTCA0Mi4xMzcgMjMgTCAzOC4yMzcgMjguNCBDIDM3LjkzNyAyOC44IDM4LjIzNyAyOS40IDM4LjczNyAyOS40IEwgNDIuNDM3IDI5LjQgQyA0Mi44MzcgMjkuNCA0My4xMzcgMjkuMiA0My4zMzcgMjguOSBMIDU1LjgzNyAxMC45IEMgNTYuMTM3IDEwLjYgNTUuODM3IDEwIDU1LjMzNyAxMCBaIj48L3BhdGg+PHBhdGggZmlsbD0iIzAwOWNkZSIgZD0iTSA2Ny43MzcgMi44IEwgNTkuOTM3IDIuOCBDIDU5LjQzNyAyLjggNTguOTM3IDMuMiA1OC44MzcgMy43IEwgNTUuNzM3IDIzLjYgQyA1NS42MzcgMjQgNTUuOTM3IDI0LjMgNTYuMzM3IDI0LjMgTCA2MC4zMzcgMjQuMyBDIDYwLjczNyAyNC4zIDYxLjAzNyAyNCA2MS4wMzcgMjMuNyBMIDYxLjkzNyAxOCBDIDYyLjAzNyAxNy41IDYyLjQzNyAxNy4xIDYzLjAzNyAxNy4xIEwgNjUuNTM3IDE3LjEgQyA3MC42MzcgMTcuMSA3My42MzcgMTQuNiA3NC40MzcgOS43IEMgNzQuNzM3IDcuNiA3NC40MzcgNS45IDczLjQzNyA0LjcgQyA3Mi4yMzcgMy41IDcwLjMzNyAyLjggNjcuNzM3IDIuOCBaIE0gNjguNjM3IDEwLjEgQyA2OC4yMzcgMTIuOSA2Ni4wMzcgMTIuOSA2NC4wMzcgMTIuOSBMIDYyLjgzNyAxMi45IEwgNjMuNjM3IDcuNyBDIDYzLjYzNyA3LjQgNjMuOTM3IDcuMiA2NC4yMzcgNy4yIEwgNjQuNzM3IDcuMiBDIDY2LjEzNyA3LjIgNjcuNDM3IDcuMiA2OC4xMzcgOCBDIDY4LjYzNyA4LjQgNjguNzM3IDkuMSA2OC42MzcgMTAuMSBaIj48L3BhdGg+PHBhdGggZmlsbD0iIzAwOWNkZSIgZD0iTSA5MC45MzcgMTAgTCA4Ny4yMzcgMTAgQyA4Ni45MzcgMTAgODYuNjM3IDEwLjIgODYuNjM3IDEwLjUgTCA4Ni40MzcgMTEuNSBMIDg2LjEzNyAxMS4xIEMgODUuMzM3IDkuOSA4My41MzcgOS41IDgxLjczNyA5LjUgQyA3Ny42MzcgOS41IDc0LjEzNyAxMi42IDczLjQzNyAxNyBDIDczLjAzNyAxOS4yIDczLjUzNyAyMS4zIDc0LjgzNyAyMi43IEMgNzUuOTM3IDI0IDc3LjYzNyAyNC42IDc5LjUzNyAyNC42IEMgODIuODM3IDI0LjYgODQuNzM3IDIyLjUgODQuNzM3IDIyLjUgTCA4NC41MzcgMjMuNSBDIDg0LjQzNyAyMy45IDg0LjczNyAyNC4zIDg1LjEzNyAyNC4zIEwgODguNTM3IDI0LjMgQyA4OS4wMzcgMjQuMyA4OS41MzcgMjMuOSA4OS42MzcgMjMuNCBMIDkxLjYzNyAxMC42IEMgOTEuNjM3IDEwLjQgOTEuMzM3IDEwIDkwLjkzNyAxMCBaIE0gODUuNzM3IDE3LjIgQyA4NS4zMzcgMTkuMyA4My43MzcgMjAuOCA4MS41MzcgMjAuOCBDIDgwLjQzNyAyMC44IDc5LjYzNyAyMC41IDc5LjAzNyAxOS44IEMgNzguNDM3IDE5LjEgNzguMjM3IDE4LjIgNzguNDM3IDE3LjIgQyA3OC43MzcgMTUuMSA4MC41MzcgMTMuNiA4Mi42MzcgMTMuNiBDIDgzLjczNyAxMy42IDg0LjUzNyAxNCA4NS4xMzcgMTQuNiBDIDg1LjczNyAxNS4zIDg1LjkzNyAxNi4yIDg1LjczNyAxNy4yIFoiPjwvcGF0aD48cGF0aCBmaWxsPSIjMDA5Y2RlIiBkPSJNIDk1LjMzNyAzLjMgTCA5Mi4xMzcgMjMuNiBDIDkyLjAzNyAyNCA5Mi4zMzcgMjQuMyA5Mi43MzcgMjQuMyBMIDk1LjkzNyAyNC4zIEMgOTYuNDM3IDI0LjMgOTYuOTM3IDIzLjkgOTcuMDM3IDIzLjQgTCAxMDAuMjM3IDMuNSBDIDEwMC4zMzcgMy4xIDEwMC4wMzcgMi44IDk5LjYzNyAyLjggTCA5Ni4wMzcgMi44IEMgOTUuNjM3IDIuOCA5NS40MzcgMyA5NS4zMzcgMy4zIFoiPjwvcGF0aD48L3N2Zz4=');
                  background-repeat: no-repeat;
                  background-position: center;
                  background-size: 80px 25px;
                  color: transparent;
                  font-weight: bold;
                  border: none;
                  font-size: 1rem;
                  margin: 0 auto;
                "
              ></button>
              <!-- Razorpay Button -->
              <button
                id="rzp-button"
                class="btn-razorpay"
                style="padding: 10px 0px"
              >
                <svg
                  width="18"
                  height="20"
                  viewBox="0 0 18 20"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M7.077 6.476l-.988 3.569 5.65-3.589-3.695 13.54 3.752.004 5.457-20L7.077 6.476z"
                    fill="#fff"
                    data-darkreader-inline-fill=""
                    style="
                      --darkreader-inline-fill: var(
                        --darkreader-text-ffffff,
                        #e8e6e3
                      );
                    "
                  ></path>
                  <path
                    d="M1.455 14.308L0 20h7.202L10.149 8.42l-8.694 5.887z"
                    fill="#fff"
                    data-darkreader-inline-fill=""
                    style="
                      --darkreader-inline-fill: var(
                        --darkreader-text-ffffff,
                        #e8e6e3
                      );
                    "
                  ></path>
                </svg>
                RAZORPAY
              </button>
            </div>
          </div>
          <div
            id="onetime-premium-msg"
            style="
              display: none;
              text-align: center;
              padding: 40px 20px;
              background: rgba(255, 255, 255, 0.05);
              border-radius: 12px;
              border: 1px solid rgba(255, 70, 85, 0.3);
              margin-top: 20px;
            "
          ></div>
        </div>

        <!-- Subscription Tab -->
        <div id="subscription" class="tab-content">
          <div class="input-group" id="sub-user-id-group">
            <label for="sub-user-id">User ID (from App)</label>
            <input
              type="text"
              id="sub-user-id"
              placeholder="Enter your User ID"
            />
          </div>

          <div
            id="subscription-payment-section"
            style="
              margin-top: 20px;
              padding: 20px;
              background: rgba(255, 255, 255, 0.05);
              border-radius: 12px;
              border: 1px solid rgba(255, 70, 85, 0.3);
            "
          >
            <div style="text-align: center; margin-bottom: 20px">
              <h3
                style="
                  color: var(--val-red);
                  margin: 0 0 8px 0;
                  font-size: 1.5rem;
                  font-weight: 700;
                "
              >
                ValNarrator Premium
              </h3>
              <div
                style="
                  color: #ebebf0;
                  font-size: 2rem;
                  font-weight: bold;
                  margin: 8px 0;
                "
              >
                $2.00<span style="font-size: 1rem; color: var(--val-gray)"
                  >/month</span
                >
              </div>
              <p
                style="
                  color: var(--val-gray);
                  margin: 12px 0 20px 0;
                  line-height: 1.6;
                  font-size: 0.95rem;
                "
              >
                Enhanced in-game text-to-speech experience for Valorant players.
                Includes unlimited narration quota, premium voice options, and
                faster performance.
              </p>
            </div>

            <div style="display: flex; justify-content: center">
              <button
                id="subscribe-btn"
                class="btn"
                style="
                  width: 200px;
                  height: 48px;
                  clip-path: none;
                  border-radius: 4px;
                  background-color: #7f5900;
                  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAxcHgiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAxMDEgMzIiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaW5ZTWluIG1lZXQiIHhtbG5zPSJodHRwOiYjeDJGOyYjeDJGO3d3dy53My5vcmcmI3gyRjsyMDAwJiN4MkY7c3ZnIj48cGF0aCBmaWxsPSIjMDAzMDg3IiBkPSJNIDEyLjIzNyAyLjggTCA0LjQzNyAyLjggQyAzLjkzNyAyLjggMy40MzcgMy4yIDMuMzM3IDMuNyBMIDAuMjM3IDIzLjcgQyAwLjEzNyAyNC4xIDAuNDM3IDI0LjQgMC44MzcgMjQuNCBMIDQuNTM3IDI0LjQgQyA1LjAzNyAyNC40IDUuNTM3IDI0IDUuNjM3IDIzLjUgTCA2LjQzNyAxOC4xIEMgNi41MzcgMTcuNiA2LjkzNyAxNy4yIDcuNTM3IDE3LjIgTCAxMC4wMzcgMTcuMiBDIDE1LjEzNyAxNy4yIDE4LjEzNyAxNC43IDE4LjkzNyA5LjggQyAxOS4yMzcgNy43IDE4LjkzNyA2IDE3LjkzNyA0LjggQyAxNi44MzcgMy41IDE0LjgzNyAyLjggMTIuMjM3IDIuOCBaIE0gMTMuMTM3IDEwLjEgQyAxMi43MzcgMTIuOSAxMC41MzcgMTIuOSA4LjUzNyAxMi45IEwgNy4zMzcgMTIuOSBMIDguMTM3IDcuNyBDIDguMTM3IDcuNCA4LjQzNyA3LjIgOC43MzcgNy4yIEwgOS4yMzcgNy4yIEMgMTAuNjM3IDcuMiAxMS45MzcgNy4yIDEyLjYzNyA4IEMgMTMuMTM3IDguNCAxMy4zMzcgOS4xIDEzLjEzNyAxMC4xIFoiPjwvcGF0aD48cGF0aCBmaWxsPSIjMDAzMDg3IiBkPSJNIDM1LjQzNyAxMCBMIDMxLjczNyAxMCBDIDMxLjQzNyAxMCAzMS4xMzcgMTAuMiAzMS4xMzcgMTAuNSBMIDMwLjkzNyAxMS41IEwgMzAuNjM3IDExLjEgQyAyOS44MzcgOS45IDI4LjAzNyA5LjUgMjYuMjM3IDkuNSBDIDIyLjEzNyA5LjUgMTguNjM3IDEyLjYgMTcuOTM3IDE3IEMgMTcuNTM3IDE5LjIgMTguMDM3IDIxLjMgMTkuMzM3IDIyLjcgQyAyMC40MzcgMjQgMjIuMTM3IDI0LjYgMjQuMDM3IDI0LjYgQyAyNy4zMzcgMjQuNiAyOS4yMzcgMjIuNSAyOS4yMzcgMjIuNSBMIDI5LjAzNyAyMy41IEMgMjguOTM3IDIzLjkgMjkuMjM3IDI0LjMgMjkuNjM3IDI0LjMgTCAzMy4wMzcgMjQuMyBDIDMzLjUzNyAyNC4zIDM0LjAzNyAyMy45IDM0LjEzNyAyMy40IEwgMzYuMTM3IDEwLjYgQyAzNi4yMzcgMTAuNCAzNS44MzcgMTAgMzUuNDM3IDEwIFogTSAzMC4zMzcgMTcuMiBDIDI5LjkzNyAxOS4zIDI4LjMzNyAyMC44IDI2LjEzNyAyMC44IEMgMjUuMDM3IDIwLjggMjQuMjM3IDIwLjUgMjMuNjM3IDE5LjggQyAyMy4wMzcgMTkuMSAyMi44MzcgMTguMiAyMy4wMzcgMTcuMiBDIDIzLjMzNyAxNS4xIDI1LjEzNyAxMy42IDI3LjIzNyAxMy42IEMgMjguMzM3IDEzLjYgMjkuMTM3IDE0IDI5LjczNyAxNC42IEMgMzAuMjM3IDE1LjMgMzAuNDM3IDE2LjIgMzAuMzM3IDE3LjIgWiI+PC9wYXRoPjxwYXRoIGZpbGw9IiMwMDMwODciIGQ9Ik0gNTUuMzM3IDEwIEwgNTEuNjM3IDEwIEMgNTEuMjM3IDEwIDUwLjkzNyAxMC4yIDUwLjczNyAxMC41IEwgNDUuNTM3IDE4LjEgTCA0My4zMzcgMTAuOCBDIDQzLjIzNyAxMC4zIDQyLjczNyAxMCA0Mi4zMzcgMTAgTCAzOC42MzcgMTAgQyAzOC4yMzcgMTAgMzcuODM3IDEwLjQgMzguMDM3IDEwLjkgTCA0Mi4xMzcgMjMgTCAzOC4yMzcgMjguNCBDIDM3LjkzNyAyOC44IDM4LjIzNyAyOS40IDM4LjczNyAyOS40IEwgNDIuNDM3IDI5LjQgQyA0Mi44MzcgMjkuNCA0My4xMzcgMjkuMiA0My4zMzcgMjguOSBMIDU1LjgzNyAxMC45IEMgNTYuMTM3IDEwLjYgNTUuODM3IDEwIDU1LjMzNyAxMCBaIj48L3BhdGg+PHBhdGggZmlsbD0iIzAwOWNkZSIgZD0iTSA2Ny43MzcgMi44IEwgNTkuOTM3IDIuOCBDIDU5LjQzNyAyLjggNTguOTM3IDMuMiA1OC44MzcgMy43IEwgNTUuNzM3IDIzLjYgQyA1NS42MzcgMjQgNTUuOTM3IDI0LjMgNTYuMzM3IDI0LjMgTCA2MC4zMzcgMjQuMyBDIDYwLjczNyAyNC4zIDYxLjAzNyAyNCA2MS4wMzcgMjMuNyBMIDYxLjkzNyAxOCBDIDYyLjAzNyAxNy41IDYyLjQzNyAxNy4xIDYzLjAzNyAxNy4xIEwgNjUuNTM3IDE3LjEgQyA3MC42MzcgMTcuMSA3My42MzcgMTQuNiA3NC40MzcgOS43IEMgNzQuNzM3IDcuNiA3NC40MzcgNS45IDczLjQzNyA0LjcgQyA3Mi4yMzcgMy41IDcwLjMzNyAyLjggNjcuNzM3IDIuOCBaIE0gNjguNjM3IDEwLjEgQyA2OC4yMzcgMTIuOSA2Ni4wMzcgMTIuOSA2NC4wMzcgMTIuOSBMIDYyLjgzNyAxMi45IEwgNjMuNjM3IDcuNyBDIDYzLjYzNyA3LjQgNjMuOTM3IDcuMiA2NC4yMzcgNy4yIEwgNjQuNzM3IDcuMiBDIDY2LjEzNyA3LjIgNjcuNDM3IDcuMiA2OC4xMzcgOCBDIDY4LjYzNyA4LjQgNjguNzM3IDkuMSA2OC42MzcgMTAuMSBaIj48L3BhdGg+PHBhdGggZmlsbD0iIzAwOWNkZSIgZD0iTSA5MC45MzcgMTAgTCA4Ny4yMzcgMTAgQyA4Ni45MzcgMTAgODYuNjM3IDEwLjIgODYuNjM3IDEwLjUgTCA4Ni40MzcgMTEuNSBMIDg2LjEzNyAxMS4xIEMgODUuMzM3IDkuOSA4My41MzcgOS41IDgxLjczNyA5LjUgQyA3Ny42MzcgOS41IDc0LjEzNyAxMi42IDczLjQzNyAxNyBDIDczLjAzNyAxOS4yIDczLjUzNyAyMS4zIDc0LjgzNyAyMi43IEMgNzUuOTM3IDI0IDc3LjYzNyAyNC42IDc5LjUzNyAyNC42IEMgODIuODM3IDI0LjYgODQuNzM3IDIyLjUgODQuNzM3IDIyLjUgTCA4NC41MzcgMjMuNSBDIDg0LjQzNyAyMy45IDg0LjczNyAyNC4zIDg1LjEzNyAyNC4zIEwgODguNTM3IDI0LjMgQyA4OS4wMzcgMjQuMyA4OS41MzcgMjMuOSA4OS42MzcgMjMuNCBMIDkxLjYzNyAxMC42IEMgOTEuNjM3IDEwLjQgOTEuMzM3IDEwIDkwLjkzNyAxMCBaIE0gODUuNzM3IDE3LjIgQyA4NS4zMzcgMTkuMyA4My43MzcgMjAuOCA4MS41MzcgMjAuOCBDIDgwLjQzNyAyMC44IDc5LjYzNyAyMC41IDc5LjAzNyAxOS44IEMgNzguNDM3IDE5LjEgNzguMjM3IDE4LjIgNzguNDM3IDE3LjIgQyA3OC43MzcgMTUuMSA4MC41MzcgMTMuNiA4Mi42MzcgMTMuNiBDIDgzLjczNyAxMy42IDg0LjUzNyAxNCA4NS4xMzcgMTQuNiBDIDg1LjczNyAxNS4zIDg1LjkzNyAxNi4yIDg1LjczNyAxNy4yIFoiPjwvcGF0aD48cGF0aCBmaWxsPSIjMDA5Y2RlIiBkPSJNIDk1LjMzNyAzLjMgTCA5Mi4xMzcgMjMuNiBDIDkyLjAzNyAyNCA5Mi4zMzcgMjQuMyA5Mi43MzcgMjQuMyBMIDk1LjkzNyAyNC4zIEMgOTYuNDM3IDI0LjMgOTYuOTM3IDIzLjkgOTcuMDM3IDIzLjQgTCAxMDAuMjM3IDMuNSBDIDEwMC4zMzcgMy4xIDEwMC4wMzcgMi44IDk5LjYzNyAyLjggTCA5Ni4wMzcgMi44IEMgOTUuNjM3IDIuOCA5NS40MzcgMyA5NS4zMzcgMy4zIFoiPjwvcGF0aD48L3N2Zz4=');
                  background-repeat: no-repeat;
                  background-position: center;
                  background-size: 80px 25px;
                  color: transparent;
                  font-weight: bold;
                  border: none;
                  font-size: 1rem;
                  margin: 0 auto;
                "
              >
                Subscribe Monthly
              </button>
            </div>
            <p
              class="payment-note"
              style="margin-top: 12px; text-align: center"
            >
              You will be redirected to PayPal to complete the subscription.
            </p>
          </div>
          <div
            id="subs-premium-msg"
            style="
              display: none;
              text-align: center;
              padding: 40px 20px;
              background: rgba(255, 255, 255, 0.05);
              border-radius: 12px;
              border: 1px solid rgba(255, 70, 85, 0.3);
              margin-top: 20px;
            "
          ></div>
        </div>
      </div>
    </div>

    <script src="https://www.paypal.com/sdk/js?client-id=AY25BXsvQ1dmoGa9gpjbOuWNo40pJQLnB-pZ5GNpOizjo67CYIZApVFY_Qm9xmSHKX9glqYHoZDoHwWB&currency=USD"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
      // Modal Logic
      const modal = document.getElementById("payment-modal");
      const buyBtn = document.getElementById("buy-btn");
      const closeBtn = document.querySelector(".close-modal");

      const subUserIdInput = document.getElementById("sub-user-id");
      const oneTimeUserIdInput = document.getElementById("one-time-user-id");
      const subUserIdGroup = document.getElementById("sub-user-id-group");
      const oneTimeUserIdGroup = document.getElementById(
        "one-time-user-id-group"
      );
      const referralLink = document.getElementById("referral-link");
      const paypalCustomIdInput = document.getElementById("paypal-custom-id");

      // Update Referral Link with User ID
      function updateReferralLink(uid) {
        if (uid) {
          referralLink.href = `/referral?user-id=${uid}`;
        } else {
          referralLink.href = "/referral";
        }
      }

      // Update PayPal Custom ID
      function updatePayPalCustomId(uid) {
        if (paypalCustomIdInput) {
          paypalCustomIdInput.value = uid || "";
        }
      }

      // Check URL or LocalStorage on load
      const urlParams = new URLSearchParams(window.location.search);
      let initialUserId =
        urlParams.get("userId") ||
        urlParams.get("user-id") ||
        localStorage.getItem("userid");

      const onetimePaymentContainer = document.getElementById(
        "onetime-payment-section"
      );
      const subsPaymentContainer = document.getElementById(
        "subscription-payment-section"
      );
      const subscribeBtn = document.getElementById("subscribe-btn");

      function setPaymentState(enabled) {
        if (enabled) {
          onetimePaymentContainer.style.opacity = "1";
          onetimePaymentContainer.style.pointerEvents = "auto";
          subsPaymentContainer.style.opacity = "1";
          subsPaymentContainer.style.pointerEvents = "auto";
          subscribeBtn.disabled = false;
          subscribeBtn.innerText = "Subscribe Monthly";
        } else {
          onetimePaymentContainer.style.opacity = "0.5";
          onetimePaymentContainer.style.pointerEvents = "none";
          subsPaymentContainer.style.opacity = "0.5";
          subsPaymentContainer.style.pointerEvents = "none";
          subscribeBtn.disabled = true;
          subscribeBtn.innerText = "Enter Valid User ID";
        }
      }

      // Initial state: Disabled
      setPaymentState(false);

      async function verifyUser(uid, isUrlParam = false) {
        if (!uid) {
          setPaymentState(false);
          updatePayPalCustomId("");
          return false;
        }

        try {
          const response = await fetch(`/user/${uid}`);
          if (!response.ok) {
            setPaymentState(false);
            updatePayPalCustomId("");
            if (isUrlParam) {
              window.location.href = "/";
            }
            return false;
          }

          const data = await response.json();

          const onetimePremiumMsg = document.getElementById(
            "onetime-premium-msg"
          );
          const subsPremiumMsg = document.getElementById("subs-premium-msg");

          if (data.premium) {
            // User is premium
            let premiumTill = "Lifetime";
            if (
              data.premium_till &&
              data.premium_till !== 0 &&
              data.premium_till !== "0"
            ) {
              premiumTill = new Date(
                data.premium_till * 1000
              ).toLocaleDateString();
            }

            const premiumContent = `
                <div style="font-size: 3rem; margin-bottom: 20px;">ðŸ‘‘</div>
                <h3 style="color: var(--val-red); font-size: 1.8rem; margin-bottom: 10px;">Premium Active</h3>
                <p style="color: #ebebf0; font-size: 1.1rem;">You are already a premium member!</p>
                <p style="color: var(--val-gray); margin-top: 10px;">Valid till: ${premiumTill}</p>
             `;

            onetimePremiumMsg.innerHTML = premiumContent;
            subsPremiumMsg.innerHTML = premiumContent;

            // onetimePaymentContainer.style.display = "none";
            // subsPaymentContainer.style.display = "none";

            onetimePremiumMsg.style.display = "block";
            subsPremiumMsg.style.display = "block";
          } else {
            onetimePaymentContainer.style.display = "block";
            subsPaymentContainer.style.display = "block";

            // onetimePremiumMsg.style.display = "none";
            // subsPremiumMsg.style.display = "none";

            setPaymentState(true);
          }

          updatePayPalCustomId(uid);
          return true;
        } catch (error) {
          console.error("Verification error:", error);
          setPaymentState(false);
          updatePayPalCustomId("");
          return false;
        }
      }

      if (initialUserId) {
        updateReferralLink(initialUserId);

        // If from URL, verify strictly
        const isFromUrl = urlParams.has("userId") || urlParams.has("user-id");
        if (isFromUrl) {
          verifyUser(initialUserId, true);
        } else {
          // If from local storage, verify silently but don't alert if fails (just keep disabled)
          verifyUser(initialUserId, false);
        }
      }

      buyBtn.onclick = function () {
        modal.style.display = "flex";

        // Auto-fill User ID if present in URL or LocalStorage
        const urlParams = new URLSearchParams(window.location.search);
        let userId = urlParams.get("userId") || urlParams.get("user-id");

        if (userId) {
          subUserIdInput.value = userId;
          oneTimeUserIdInput.value = userId;
          subUserIdInput.disabled = true;
          oneTimeUserIdInput.disabled = true;
          // Verification happened on load
        } else {
          userId = localStorage.getItem("userid");
          if (userId) {
            subUserIdInput.value = userId;
            oneTimeUserIdInput.value = userId;
            // Verify again to be sure
            verifyUser(userId, false);
          }
          subUserIdInput.disabled = false;
          oneTimeUserIdInput.disabled = false;
        }
      };

      // Sync inputs and Verify on Blur
      function handleInput(e) {
        const val = e.target.value;
        subUserIdInput.value = val;
        oneTimeUserIdInput.value = val;
        localStorage.setItem("userid", val);
        updatePayPalCustomId(val);

        // Disable immediately on change until verified
        setPaymentState(false);
      }

      function handleBlur(e) {
        const val = e.target.value;
        if (val) {
          verifyUser(val, false);
        }
      }

      subUserIdInput.addEventListener("input", handleInput);
      oneTimeUserIdInput.addEventListener("input", handleInput);

      subUserIdInput.addEventListener("blur", handleBlur);
      oneTimeUserIdInput.addEventListener("blur", handleBlur);

      closeBtn.onclick = function () {
        modal.style.display = "none";
      };

      window.onclick = function (event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };

      function switchTab(tabName) {
        document
          .querySelectorAll(".tab-content")
          .forEach((tab) => tab.classList.remove("active"));
        document
          .querySelectorAll(".tab-btn")
          .forEach((btn) => btn.classList.remove("active"));

        document.getElementById(tabName).classList.add("active");
        event.target.classList.add("active");
      }

      // Subscription Logic
      document.getElementById("subscribe-btn").onclick = async function () {
        const userId = subUserIdInput.value.trim();
        if (!userId) {
          console.log("Please enter your User ID before subscribing.");
          return;
        }

        // Save to local storage
        localStorage.setItem("userid", userId);

        const subscribeBtn = document.getElementById("subscribe-btn");
        subscribeBtn.disabled = true;
        subscribeBtn.innerText = "Processing...";

        try {
          const payload = {
            user_id: userId,
          };

          const response = await fetch(
            "https://payment-valnarrator.vercel.app/createSubscription",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(payload),
            }
          );

          if (response.ok) {
            const subscriptionURL = response.headers.get("subscriptionURL");

            if (subscriptionURL) {
              window.location.href = subscriptionURL;
            } else {
              const text = await response.text();
              console.log("Response:", text);
              alert(
                "Subscription created but redirect URL missing. Please contact support."
              );
            }
          } else {
            alert("Failed to create subscription. Please try again.");
          }
        } catch (error) {
          console.error("Subscription Error:", error);
          alert("An error occurred. Please check console.");
        } finally {
          subscribeBtn.disabled = false;
          subscribeBtn.innerText = "Subscribe Monthly";
        }
      };
      // Razorpay Logic
      const rzpButton = document.getElementById("rzp-button");

      rzpButton.onclick = async function () {
        const userId = oneTimeUserIdInput.value.trim();
        if (!userId) {
          console.log("Please enter your User ID before razorpay payment.");
          return;
        }

        // Save to local storage
        localStorage.setItem("userid", userId);

        rzpButton.disabled = true;
        const originalText = rzpButton.innerHTML;
        rzpButton.innerText = "Processing...";

        try {
          const response = await fetch(
            "https://payment-valnarrator.vercel.app/razorpay/createPayment",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ user_id: userId }),
            }
          );

          if (!response.ok) {
            throw new Error("Network response was not ok");
          }

          const data = await response.json();

          const options = {
            key: data.razorpay_key,
            amount: 400 * 100, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
            currency: "INR",
            name: "Valorant Narrator",
            description:
              "ValNarrator Premium â€” Enhanced in-game text-to-speech experience for Valorant players. Includes unlimited narration quota, premium voice options, and faster performance.",
            order_id: data.order_id,
            handler: function (response) {
              const redirectURL =
                "https://payment-valnarrator.vercel.app/payment_return?" +
                "rp_order_id=" +
                response.razorpay_order_id +
                "&rp_payment_id=" +
                response.razorpay_payment_id +
                "&rp_signature=" +
                response.razorpay_signature;

              window.location.href = redirectURL;
            },
            theme: {
              color: "#ff4655",
            },
          };

          const rzp1 = new Razorpay(options);

          rzp1.on("payment.failed", function (response) {
            console.error("Payment failed:", response.error);
            alert("Payment Failed: " + response.error.description);
          });

          rzp1.open();
        } catch (error) {
          console.error("Error initiating Razorpay payment:", error);
          alert("Failed to initiate payment. Please try again.");
        } finally {
          rzpButton.disabled = false;
          rzpButton.innerHTML = originalText;
        }
      };
      // PayPal One-Time Logic
      const paypalOneTimeBtn = document.getElementById("one-time-paypal-btn");

      paypalOneTimeBtn.onclick = async function () {
        const userId = oneTimeUserIdInput.value.trim();
        if (!userId) {
          console.log("Please enter your User ID before PayPal payment.");
          return;
        }

        paypalOneTimeBtn.disabled = true;
        const originalText = paypalOneTimeBtn.style.backgroundImage;
        paypalOneTimeBtn.style.backgroundImage = "none";
        paypalOneTimeBtn.innerText = "Processing...";
        paypalOneTimeBtn.style.color = "white";

        try {
          const response = await fetch(
            "https://payment-valnarrator.vercel.app/paypal/createPayment",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ user_id: userId }),
            }
          );

          if (!response.ok) {
            throw new Error("Network response was not ok");
          }

          const data = await response.json();
          if (data.paymentURL) {
            window.location.href = data.paymentURL;
          } else {
            alert("Failed to get payment URL.");
          }
        } catch (error) {
          console.error("Error initiating PayPal payment:", error);
          alert("Failed to initiate payment. Please try again.");
        } finally {
          paypalOneTimeBtn.disabled = false;
          paypalOneTimeBtn.innerText = "";
          paypalOneTimeBtn.style.color = "transparent";
          paypalOneTimeBtn.style.backgroundImage = originalText;
        }
      };
    </script>
  </body>
</html>
