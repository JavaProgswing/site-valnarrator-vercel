<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valorant Narrator - Real-time Game Chat to Voice</title>
    <meta name="description" content="Valorant Narrator transforms game chat messages into real-time party and team voice communication with customizable agent voices.">
    <meta property="og:title" content="Valorant Narrator">
    <meta property="og:description" content="Dictate your chat comms into team/party mic with fully customizable voices!">
    <meta property="og:image" content="https://valnarrator.vercel.app/static/images/bg-site.png">
    <meta name="theme-color" content="#ff4655">
    
    <link rel="icon" href="static/app.ico">
    <link rel="stylesheet" href="static/style.css">
    <!-- Google Fonts included in style.css -->
</head>
<body>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container hero-content">
            <h1>Valorant<br>Narrator</h1>
            <p>Transform text chat into real-time voice comms. Immerse yourself with authentic agent voices.</p>
            <div class="hero-buttons">
                <a href="/download" class="btn">Download Now</a>
                <a href="https://discord.gg/RWP25YQDcf" class="btn btn-outline">Join Discord</a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features">
        <div class="container">
            <h2 class="section-title">Features</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <img src="static/images/7649719-99138a52.png" alt="Performance Icon">
                    </div>
                    <h3>Zero Lag</h3>
                    <p>Optimized for performance. Valorant Narrator runs seamlessly in the background with no impact on your FPS.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <img src="static/images/563541-f40a75b3.png" alt="Config Icon">
                    </div>
                    <h3>Highly Configurable</h3>
                    <p>Customize everything from voice speed to specific trigger words. Make it truly yours.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <img src="static/images/3138411-46379e46.png" alt="Voices Icon">
                    </div>
                    <h3>Agent Voices</h3>
                    <p>Choose from over 12+ voices, including your favorite agents. Free tier includes unlimited Windows voices.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials">
        <div class="container">
            <h2 class="section-title">Community Love</h2>
            <div class="testimonial-slider">
                <div class="testimonial-card">
                    <p class="testimonial-text">"You are a community treasure my friend. If this works, It will be a godsend for me. I have lost count of the number of times when my teammate is typing in chat instead of using their mic."</p>
                    <p class="testimonial-author">- Reddit User</p>
                </div>
                <div class="testimonial-card">
                    <p class="testimonial-text">"That sounds like a pretty interesting and potentially useful application... hearing the chat come through as voice adds another layer to the game's communication system."</p>
                    <p class="testimonial-author">- Reddit User</p>
                </div>
                <div class="testimonial-card">
                    <p class="testimonial-text">"Being a girl, this will honestly save me a lot of sanity when not wanting to talk when there are toxic people in my match. I definitely see using this in the future."</p>
                    <p class="testimonial-author">- Reddit User</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta">
        <div class="container">
            <h2>Ready to Upgrade Your Comms?</h2>
            <p>Free tier includes AWS Voices (limited) + Agent voices.<br><strong>Go Premium for unlimited quota and offline access!</strong></p>
            <div class="hero-buttons">
                <a href="/download" class="btn">Download App</a>
                <button id="buy-btn" class="btn btn-outline" style="cursor: pointer;">Buy Premium (â‚¹199)</button>
            </div>
            <div style="margin-top: 20px;">
                 <a href="/referral" style="color: var(--val-gray); font-size: 0.9rem; text-decoration: underline;">Have a Referral Code?</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <a href="https://discord.gg/RWP25YQDcf" class="discord-link">
                <img src="static/images/discordlogo.png" alt="Discord">
                Join our Community
            </a>
            <div class="footer-links">
                <a href="/TermsOfService">Terms of Service</a>
                <a href="/PrivacyPolicy">Privacy Policy</a>
                <a href="/CancellationRefundPolicy">Refund Policy</a>
            </div>
            <p style="margin-top: 20px; color: #555; font-size: 0.8rem;">&copy; 2023 Valorant Narrator. Not affiliated with Riot Games.</p>
        </div>
    </footer>

    <!-- Payment Modal -->
    <div id="payment-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 style="text-align: center; margin-bottom: 20px; color: var(--val-red);">Choose Your Plan</h2>
            
            <div class="payment-tabs">
                <button class="tab-btn active" onclick="switchTab('one-time')">One Time</button>
                <button class="tab-btn" onclick="switchTab('subscription')">Subscription</button>
            </div>

            <!-- One Time Payment Tab -->
            <div id="one-time" class="tab-content active">
                <p style="text-align: center; margin-bottom: 20px;">Get permanent access to premium features.</p>
                
                <div class="input-group" id="one-time-user-id-group">
                    <label for="one-time-user-id">User ID (from App)</label>
                    <input type="text" id="one-time-user-id" placeholder="Enter your User ID">
                </div>

                <div id="paypal-container-9T3V8M3MFPBNE" style="text-align: center; margin-top: 20px;"></div>
                <p class="payment-note">Powered by PayPal Secure Checkout</p>
            </div>

            <!-- Subscription Tab -->
            <div id="subscription" class="tab-content">
                <p style="text-align: center; margin-bottom: 20px;">Monthly access to all premium features.</p>
                <div class="input-group" id="sub-user-id-group">
                    <label for="sub-user-id">User ID (from App)</label>
                    <input type="text" id="sub-user-id" placeholder="Enter your User ID">
                </div>
                <button id="subscribe-btn" class="btn" style="width: 100%; clip-path: none; border-radius: 4px;">Subscribe Monthly</button>
                <p class="payment-note">You will be redirected to PayPal to complete the subscription.</p>
            </div>
        </div>
    </div>

    <script src="https://www.paypal.com/sdk/js?client-id=BAAF9VySvCCI2VQbOYDDLiqEiSXGcJjn4F1_mlOQ8rir20xMnopMvB6DFJfR2uDO_NXU0PVNfbAkFB7lXI&components=hosted-buttons&disable-funding=venmo&currency=USD"></script>
    <script>
        // Modal Logic
        const modal = document.getElementById('payment-modal');
        const buyBtn = document.getElementById('buy-btn');
        const closeBtn = document.querySelector('.close-modal');
        
        const subUserIdInput = document.getElementById('sub-user-id');
        const oneTimeUserIdInput = document.getElementById('one-time-user-id');
        const subUserIdGroup = document.getElementById('sub-user-id-group');
        const oneTimeUserIdGroup = document.getElementById('one-time-user-id-group');

        buyBtn.onclick = function() {
            modal.style.display = 'flex';
            
            // Auto-fill User ID if present in URL or LocalStorage
            const urlParams = new URLSearchParams(window.location.search);
            let userId = urlParams.get('userId');
            
            if (userId) {
                // If in URL, pre-fill and maybe hide or disable? 
                // User said: "ask... only if current page doesn't have..."
                // So we hide the input if it's in the URL to keep it clean, 
                // OR we just pre-fill it. Hiding might be better UX if we are sure.
                // Let's pre-fill and disable it to show it's locked in.
                subUserIdInput.value = userId;
                oneTimeUserIdInput.value = userId;
                subUserIdInput.disabled = true;
                oneTimeUserIdInput.disabled = true;
            } else {
                // Check local storage if not in URL
                userId = localStorage.getItem("userid");
                if (userId) {
                    subUserIdInput.value = userId;
                    oneTimeUserIdInput.value = userId;
                }
                // Ensure inputs are enabled if not from URL
                subUserIdInput.disabled = false;
                oneTimeUserIdInput.disabled = false;
            }
        }

        // Sync inputs
        subUserIdInput.addEventListener('input', function() {
            oneTimeUserIdInput.value = this.value;
            localStorage.setItem("userid", this.value);
        });
        oneTimeUserIdInput.addEventListener('input', function() {
            subUserIdInput.value = this.value;
            localStorage.setItem("userid", this.value);
        });

        closeBtn.onclick = function() {
            modal.style.display = 'none';
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // PayPal Hosted Button (One Time)
        paypal.HostedButtons({
            hostedButtonId: "9T3V8M3MFPBNE",
        }).render("#paypal-container-9T3V8M3MFPBNE");

        // Subscription Logic
        document.getElementById('subscribe-btn').onclick = async function() {
            const userId = subUserIdInput.value.trim();
            if (!userId) {
                alert("Please enter your User ID.");
                return;
            }
            
            // Save to local storage
            localStorage.setItem("userid", userId);

            const subscribeBtn = document.getElementById('subscribe-btn');
            subscribeBtn.disabled = true;
            subscribeBtn.innerText = "Processing...";

            try {
                const payload = {
                    plan_id: "P-09E05488G5362274WMTB3YGQ",
                    quantity: "1",
                    custom_id: userId,
                    application_context: {
                        shipping_preference: "NO_SHIPPING",
                        return_url: "https://payment-valnarrator.vercel.app/payment_return",
                        cancel_url: "https://payment-valnarrator.vercel.app/payment_cancel"
                    }
                };

                const response = await fetch("https://payment-valnarrator.vercel.app/createSubscription", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    const subscriptionURL = response.headers.get("subscriptionURL");
                    
                    if (subscriptionURL) {
                        window.location.href = subscriptionURL;
                    } else {
                        const text = await response.text();
                        console.log("Response:", text);
                        alert("Subscription created but redirect URL missing. Please contact support.");
                    }
                } else {
                    alert("Failed to create subscription. Please try again.");
                }
            } catch (error) {
                console.error("Subscription Error:", error);
                alert("An error occurred. Please check console.");
            } finally {
                subscribeBtn.disabled = false;
                subscribeBtn.innerText = "Subscribe Monthly";
            }
        }
    </script>

</body>
</html>